# Zabbix-UniFi-Template

## Описание
UniFi Template

## Системные требования
Из строго обязательных требований:
* Python + модуль requests
* Zabbix Sender
* Zabbix Agent
  
Условно-необязательными требованиями будем считать версии ПО, которые использовались при написании и тестировании шаблона. Здесь могут быть отклонения в разумных пределах, но, как говорится, на ваш страх и риск
* Zabbix 6.4
* Unifi Controller  7.5.187
* Python 3.6

##  Подготовка

### Установка Zabbix Sender
Если на хосте уже стоит агент, значит необходимые репозитории уже подключены, этот этап пропустим:
```
dnf install zabbix-sender -y
```

### Подготовка скрипта к работе
Исходим из предположения, что скрипт располагается в `/etc/zabbix/scripts` и называется `unifi.py`. Копируем файл скрипта по указанному адресу. Если расположение или имя файла будут другими, нужно не забыть учесть соответствующие измения при конфигурации агента. После копирования файла в нужное место, нужно сделать его исполняемым
```
chmod +x /etc/zabbix/scripts/unifi.py
```


### Настройка Zabbix Agent
В файл конфигурации агента следует добавить следующие строки, не забывая указать в конце второй строки актуальный IP-адреса сервера Zabbix:
```
UserParameter=unifi.device.discover[*],/etc/zabbix/scripts/unifi.py -server $1 -port $2 -username $3 -password $4
UserParameter=unifi.device.data[*],/etc/zabbix/scripts/unifi.py -server $1 -port $2 -username $3 -password $4 -site $5 -zabbix 127.0.0.1
```
После изменения файла конфигурации агента, понадобится его перезапуск. Что-то вроде
```
systemctl restart zabbix-agent
```

